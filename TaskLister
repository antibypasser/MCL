$currentUser = $env:USERNAME

Write-Host "`nChecking for scheduled tasks created by: ${currentUser}`n"

$tasks = Get-ScheduledTask

$myTasks = @()
foreach ($task in $tasks) {
    try {
        # Export as XML to read Author field
        $xml = [xml](Export-ScheduledTask -TaskName $task.TaskName -TaskPath $task.TaskPath)
        $author = $xml.Task.RegistrationInfo.Author

        if ($author -match "$currentUser") {
            $myTasks += [PSCustomObject]@{
                TaskName = $task.TaskName
                Path     = $task.TaskPath
                Author   = $author
            }
        }
    } catch {
        # Some system tasks can't be accessed
        continue
    }
}

if ($myTasks.Count -eq 0) {
    Write-Host "No scheduled tasks found created by: ${currentUser}"
} else {
    Write-Host "Scheduled tasks created by ${currentUser}:`n"
    $myTasks | Format-Table -AutoSize
}
